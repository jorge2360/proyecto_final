{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
  <h2>Mi Carrito</h2>

  {% if items|length %}
    <div class="table-responsive">
      <table class="table align-middle">
        <thead>
          <tr>
            <th style="min-width: 320px;">Producto</th>
            <th style="width: 120px;">Cantidad</th>
            <th style="width: 140px;">Precio</th>
            <th style="width: 160px;">Subtotal</th>
            <th style="width: 120px;"></th>
          </tr>
        </thead>
        <tbody>
          {% for item in items %}
          <tr>
            <td>
              <div class="d-flex align-items-center gap-3">
                {% if item.producto.imagen %}
                  <img src="{{ item.producto.imagen.url }}" alt="{{ item.producto.nombre }}" style="width:80px;height:80px;object-fit:cover;border-radius:8px;">
                {% endif %}
                <div>
                  <strong>{{ item.producto.nombre }}</strong><br>
                  <small class="text-muted">{{ item.producto.descripcion|truncatechars:80 }}</small>
                </div>
              </div>
            </td>
            <td>{{ item.cantidad }}</td>
            <td>Q{{ item.producto.precio }}</td>
            <td><strong>Q{{ item.subtotal }}</strong></td>
            <td>
              <a href="{% url 'carrito:eliminar' item.producto.id %}" class="btn btn-outline-danger btn-sm">Eliminar</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-3">
      <a href="{% url 'carrito:vaciar' %}" class="btn btn-warning">Vaciar carrito</a>
      <h4 class="m-0">Total: Q{{ carrito.total }}</h4>
    </div>

    <div class="text-end mt-3">
      <a href="{% url 'pagos:checkout' %}" class="btn btn-success">Proceder al pago</a>
    </div>
  {% else %}
    <div class="alert alert-info">Tu carrito está vacío.</div>
  {% endif %}
</div>
{% endblock %}
